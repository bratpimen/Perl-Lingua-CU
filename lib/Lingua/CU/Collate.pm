package Lingua::CU::Collate;

require 5.006;
use strict;
use warnings;
use utf8;

require Exporter;
require Carp;

no warnings 'utf8';
use Unicode::Collate '1.04';

our @ISA = qw(Exporter Unicode::Collate);
our $VERSION = '1.04'; ## XXX: keep version alligned with version of Unicode::Collate

my %cu = (
   locale_version => 1.02, # Updated for Unicode 8.0 features
   upper_before_lower => 1,
   suppress => [0x0400, 0x040D, 0x0419, 0x0450, 0x045D, 0x0439, 0x0407, 0x0457],
   entry => <<'ENTRY', # for DUCET v6.3.0
0487      ; [.0000.0001.0000] # COMBINING CYRILLIC POKRYTIE
A67C      ; [.0000.0001.0000] # COMBINING CYRILLIC KAVYKA
A67E      ; [.0000.0001.0000] # CYRILLIC KAVYKA
0485      ; [.0000.0002.0000] # COMBINING CYRILLIC DASIA PNEUMATA
0486      ; [.0000.0003.0000] # COMBINING CYRILLIC PSILI PNEUMATA
0301      ; [.0000.0004.0000] # COMBINING ACUTE ACCENT
00E1      ; [.15EB.0020.0002][.0000.0004.0000] # LATIN SMALL LETTER A WITH ACUTE
00C1      ; [.15EB.0020.0008][.0000.0004.0000] # LATIN CAPITAL LETTER A WITH ACUTE
00E9      ; [.1648.0020.0002][.0000.0004.0000] # LATIN SMALL LETTER E WITH ACUTE
00C9      ; [.1648.0020.0008][.0000.0004.0000] # LATIN CAPITAL LETTER E WITH ACUTE
00ED      ; [.16C9.0020.0002][.0000.0004.0000] # LATIN SMALL LETTER I WITH ACUTE
00CD      ; [.16C9.0020.0008][.0000.0004.0000] # LATIN CAPITAL LETTER I WITH ACUTE
00F3      ; [.176D.0020.0002][.0000.0004.0000] # LATIN SMALL LETTER O WITH ACUTE
00D3      ; [.176D.0020.0008][.0000.0004.0000] # LATIN CAPITAL LETTER O WITH ACUTE
00FA      ; [.1832.0020.0002][.0000.0004.0000] # LATIN SMALL LETTER U WITH ACUTE
00DA      ; [.1832.0020.0008][.0000.0004.0000] # LATIN CAPITAL LETTER U WITH ACUTE
00FD      ; [.187C.0020.0002][.0000.0004.0000] # LATIN SMALL LETTER Y WITH ACUTE
00DD      ; [.187C.0020.0008][.0000.0004.0000] # LATIN CAPITAL LETTER Y WITH ACUTE
0300      ; [.0000.0005.0000] # COMBINING GRAVE ACCENT
0311      ; [.0000.0006.0000] # COMBINING INVERTED BREVE
0483      ; [.0000.0007.0000] # COMBINING CYRILLIC TITLO
0306      ; [.0000.0008.0000] # COMBINING BREVE
0308      ; [.0000.0009.0000] # COMBINING DIAERESIS
030F      ; [.0000.0009.0000] # COMBINING DOUBLE GRAVE ACCENT
2DF6      ; [.0000.000A.0000] # COMBINING CYRILLIC LETTER A
2DE0      ; [.0000.000B.0000] # COMBINING CYRILLIC LETTER BE
2DE1      ; [.0000.000C.0000] # COMBINING CYRILLIC LETTER VE
2DE2      ; [.0000.000D.0000] # COMBINING CYRILLIC LETTER GHE
2DE3      ; [.0000.000E.0000] # COMBINING CYRILLIC LETTER DE
2DF7      ; [.0000.000F.0000] # COMBINING CYRILLIC LETTER IE
A674      ; [.0000.0010.0000] # COMBINING CYRILLIC LETTER UKRAINIAN IE
2DE4      ; [.0000.0011.0000] # COMBINING CYRILLIC LETTER ZHE
2DE5      ; [.0000.0012.0000] # COMBINING CYRILLIC LETTER ZE
A675      ; [.0000.0013.0000] # COMBINING CYRILLIC LETTER I
A676      ; [.0000.0014.0000] # COMBINING CYRILLIC LETTER YI
2DE6      ; [.0000.0015.0000] # COMBINING CYRILLIC LETTER KA
2DE7      ; [.0000.0016.0000] # COMBINING CYRILLIC LETTER EL
2DE8      ; [.0000.0017.0000] # COMBINING CYRILLIC LETTER EM
2DE9      ; [.0000.0018.0000] # COMBINING CYRILLIC LETTER EN
2DEA      ; [.0000.0019.0000] # COMBINING CYRILLIC LETTER O
A669      ; [.0000.0019.0000] # CYRILLIC SMALL LETTER MONOCULAR O
A66B      ; [.0000.0019.0000] # CYRILLIC SMALL LETTER BINOCULAR O
A66D      ; [.0000.0019.0000] # CYRILLIC SMALL LETTER DOUBLE MONOCULAR O
A66E      ; [.0000.0019.0000] # CYRILLIC LETTER MULTIOCULAR O
A67B      ; [.0000.001A.0000] # COMBINING CYRILLIC LETTER OMEGA
2DEB      ; [.0000.001B.0000] # COMBINING CYRILLIC LETTER PE
2DEC      ; [.0000.001C.0000] # COMBINING CYRILLIC LETTER ER
2DED      ; [.0000.001D.0000] # COMBINING CYRILLIC LETTER ES
2DF5      ; [.0000.001E.0000] # COMBINING CYRILLIC LETTER ES-TE
2DED 2DEE ; [.0000.001E.0000] # COMBINING CYRILLIC LETTER ES-TE
2DEE      ; [.0000.001F.0000] # COMBINING CYRILLIC LETTER TE
2DF9      ; [.0000.0020.0000] # COMBINING CYRILLIC LETTER MONOGRAPH UK
A677      ; [.0000.0021.0000] # COMBINING CYRILLIC LETTER U
A69E      ; [.0000.0022.0000] # <unknown>
2DEF      ; [.0000.0023.0000] # COMBINING CYRILLIC LETTER HA
2DF0      ; [.0000.0024.0000] # COMBINING CYRILLIC LETTER TSE
2DF1      ; [.0000.0025.0000] # COMBINING CYRILLIC LETTER CHE
2DF2      ; [.0000.0026.0000] # COMBINING CYRILLIC LETTER SHA
2DF3      ; [.0000.0027.0000] # COMBINING CYRILLIC LETTER SHCHA
2E2F      ; [.0000.0028.0000] # VERTICAL TILDE
033E      ; [.0000.0028.0000] # COMBINING VERTICAL TILDE
A678      ; [.0000.0028.0000] # COMBINING CYRILLIC LETTER HARD SIGN
A679      ; [.0000.0029.0000] # COMBINING CYRILLIC LETTER YERU
A67A      ; [.0000.002A.0000] # COMBINING CYRILLIC LETTER SOFT SIGN
A67D      ; [.0000.002A.0000] # COMBINING CYRILLIC PAYEROK
A67F      ; [.0000.002A.0000] # CYRILLIC PAYEROK
2DFA      ; [.0000.002B.0000] # COMBINING CYRILLIC LETTER YAT
2DFB      ; [.0000.002C.0000] # COMBINING CYRILLIC LETTER YU
2DFC      ; [.0000.002D.0000] # COMBINING CYRILLIC LETTER IOTIFIED A
2DFD      ; [.0000.002E.0000] # COMBINING CYRILLIC LETTER LITTLE YUS
2DFE      ; [.0000.002F.0000] # COMBINING CYRILLIC LETTER BIG YUS
2DFF      ; [.0000.0030.0000] # COMBINING CYRILLIC LETTER IOTIFIED BIG YUS
2DF4      ; [.0000.0031.0000] # COMBINING CYRILLIC LETTER FITA
003B      ; [.0000.0000.0000] # SEMICOLON
003A      ; [.0000.0000.0000] # COLON
005C      ; [.0000.0000.0000] # REVERSE SOLIDUS
002E      ; [.0000.0000.0000] # FULL STOP
002D      ; [.0000.0000.0000] # HYPHEN-MINUS
002C      ; [.0000.0000.0000] # COMMA
002A      ; [.0000.0000.0000] # ASTERISK
2013      ; [.0000.0000.0000] # EN DASH
2014      ; [.0000.0000.0000] # EM DASH
005F      ; [.0000.0000.0000] # LOW LINE
A673      ; [.0000.0000.0000] # SLAVONIC ASTERISK
0482      ; [.0000.0000.0000] # CYRILLIC THOUSANDS SIGN
20DD      ; [.0000.0000.0000] # COMBINING ENCLOSING CIRCLE
0488      ; [.0000.0000.0000] # COMBINING CYRILLIC HUNDRED THOUSANDS SIGN
0489      ; [.0000.0000.0000] # COMBINING CYRILLIC MILLIONS SIGN
A670      ; [.0000.0000.0000] # COMBINING CYRILLIC TEN MILLIONS SIGN
A671      ; [.0000.0000.0000] # COMBINING CYRILLIC HUNDRED MILLIONS SIGN
A672      ; [.0000.0000.0000] # COMBINING CYRILLIC THOUSAND MILLIONS SIGN
1C81      ; [.19C1.0020.0002] # CYRILLIC SMALL LETTER LONG-LEGGED DE
0404      ; [.19D5.0020.0009] # CYRILLIC CAPITAL LETTER UKRAINIAN IE
0454      ; [.19D5.0020.0003] # CYRILLIC SMALL LETTER UKRAINIAN IE
0405      ; [.19E2.0020.0008] # CYRILLIC CAPITAL LETTER DZE
0455      ; [.19E2.0020.0002] # CYRILLIC SMALL LETTER DZE
A640      ; [.19EE.0020.0009] # CYRILLIC CAPITAL LETTER ZEMLYA
A641      ; [.19EE.0020.0003] # CYRILLIC SMALL LETTER ZEMLYA
0406      ; [.1A07.0020.0008] # CYRILLIC CAPITAL LETTER BYELORUSSIAN-UKRAINIAN I
0456      ; [.1A07.0020.0002] # CYRILLIC SMALL LETTER BYELORUSSIAN-UKRAINIAN I
0406 0308 ; [.1A07.0020.0008][.0000.0009.0000] # CYRILLIC CAPITAL LETTER YI
0456 0308 ; [.1A07.0020.0002][.0000.0009.0000] # CYRILLIC SMALL LETTER YI
0419      ; [.1A06.0020.0008][.0000.0008.0000] # CYRILLIC CAPITAL LETTER SHORT I
0439      ; [.1A06.0020.0002][.0000.0008.0000] # CYRILLIC SMALL LETTER SHORT I
0418 0306 ; [.1A06.0020.0008][.0000.0008.0000] # CYRILLIC CAPITAL LETTER SHORT I
0438 0306 ; [.1A06.0020.0002][.0000.0008.0000] # CYRILLIC SMALL LETTER SHORT I
047A      ; [.1A5A.0020.0008] # CYRILLIC CAPITAL LETTER ROUND OMEGA
047B      ; [.1A5A.0020.0002] # CYRILLIC SMALL LETTER ROUND OMEGA
041E      ; [.1A5A.0020.0009] # CYRILLIC CAPITAL LETTER O
043E      ; [.1A5A.0020.0003] # CYRILLIC SMALL LETTER O
1C82      ; [.1A5A.0020.0003] # CYRILLIC SMALL LETTER NARROW O
0460      ; [.1A5A.0020.000A] # CYRILLIC CAPITAL LETTER OMEGA
0461      ; [.1A5A.0020.0004] # CYRILLIC SMALL LETTER OMEGA
A64C      ; [.1A5A.0020.000A] # CYRILLIC CAPITAL LETTER BROAD OMEGA
A64D      ; [.1A5A.0020.0004] # CYRILLIC SMALL LETTER BROAD OMEGA
047C      ; [.1A5A.0020.000A][.0000.0003.0000][.0000.0006.0000] # CYRILLIC CAPITAL LETTER OMEGA WITH TITLO
047D      ; [.1A5A.0020.0004][.0000.0003.0000][.0000.0006.0000] # CYRILLIC SMALL LETTER OMEGA WITH TITLO
047E      ; [.1A5A.0020.000A][.1AA2.0020.0002] # CYRILLIC CAPITAL LETTER OT
047F      ; [.1A5A.0020.0004][.1AA2.0020.0002] # CYRILLIC SMALL LETTER OT
0478      ; [.1AA3.0020.0008] # CYRILLIC CAPITAL LETTER UK
0479      ; [.1AA3.0020.0002] # CYRILLIC SMALL LETTER UK
041E 0443 ; [.1AA3.0020.0008] # <CYRILLIC CAPITAL LETTER O, CYRILLIC SMALL LETTER U>
041E 0423 ; [.1AA3.0020.0008] # <CYRILLIC CAPITAL LETTER O, CYRILLIC CAPITAL LETTER U>
043E 0443 ; [.1AA3.0020.0002] # <CYRILLIC SMALL LETTER O, CYRILLIC SMALL LETTER U>
1C82 0443 ; [.1AA3.0020.0002] # <CYRILLIC SMALL LETTER NARROW O, CYRILLIC SMALL LETTER U>
A64A      ; [.1AA3.0020.0009] # CYRILLIC CAPITAL LETTER MONOGRAPH UK
A64B      ; [.1AA3.0020.0003] # CYRILLIC SMALL LETTER MONOGRAPH UK
0423      ; [.1AA3.0020.000A] # CYRILLIC CAPITAL LETTER U
0443      ; [.1AA3.0020.0004] # CYRILLIC SMALL LETTER U
0462      ; [.1B50.0020.0009] # CYRILLIC CAPITAL LETTER YAT
0463      ; [.1B50.0020.0003] # CYRILLIC SMALL LETTER YAT
A656      ; [.1B5F.0020.0008] # CYRILLIC CAPITAL LETTER IOTIFIED A
A657      ; [.1B5F.0020.0002] # CYRILLIC SMALL LETTER IOTIFIED A
0466      ; [.19FE.0020.0003] # CYRILLIC CAPITAL LETTER LITTLE YUS
0467      ; [.1B5F.0020.0003] # CYRILLIC SMALL LETTER LITTLE YUS
046A      ; [.19FF.0020.0003] # CYRILLIC CAPITAL LETTER BIG YUS
046B      ; [.1B60.0020.0003] # CYRILLIC SMALL LETTER BIG YUS
046E      ; [.1A00.0020.0003] # CYRILLIC CAPITAL LETTER KSI
046F      ; [.1B61.0020.0003] # CYRILLIC SMALL LETTER KSI
0470      ; [.1A01.0020.0003] # CYRILLIC CAPITAL LETTER PSI
0471      ; [.1B62.0020.0003] # CYRILLIC SMALL LETTER PSI
0472      ; [.1A02.0020.0003] # CYRILLIC CAPITAL LETTER FITA
0473      ; [.1B63.0020.0003] # CYRILLIC SMALL LETTER FITA
0474      ; [.1A03.0020.0003] # CYRILLIC CAPITAL LETTER IZHITSA
0475      ; [.1B64.0020.0003] # CYRILLIC SMALL LETTER IZHITSA
0476      ; [.1A03.0020.0003][.0000.0009.0000] # CYRILLIC CAPITAL LETTER IZHITSA WITH DOUBLE GRAVE ACCENT
0477      ; [.1B64.0020.0003][.0000.0009.0000] # CYRILLIC SMALL LETTER IZHITSA WITH DOUBLE GRAVE ACCENT
1F541     ; [*1376.0020.0002] # CROSS POMMEE WITH HALF-CIRCLE BELOW
1F542     ; [*1377.0020.0002] # CROSS POMMEE
1F543     ; [*1378.0020.0002] # NOTCHED LEFT SEMICIRCLE WITH THREE DOTS
1F544     ; [*1379.0020.0002] # <unknown>
0400      ; [.19E2.0020.0008][.0000.0005.0000] # CYRILLIC CAPITAL LETTER IE WITH GRAVE
0407      ; [.1A07.0020.0008][.0000.0009.0000] # CYRILLIC CAPITAL LETTER YI
040D      ; [.1A06.0020.0008][.0000.0005.0000] # CYRILLIC CAPITAL LETTER I WITH GRAVE
0450      ; [.19D5.0020.0002][.0000.0005.0000] # CYRILLIC SMALL LETTER IE WITH GRAVE
0457      ; [.1A07.0020.0002][.0000.0009.0000] # CYRILLIC SMALL LETTER YI
045D      ; [.1A06.0020.0002][.0000.0005.0000] # CYRILLIC SMALL LETTER I WITH GRAVE
ENTRY
);

sub new {
	my $class = shift;
	my %tailoring = @_;

	while (my ($k, $v) = each %cu) {
		if (!exists $tailoring{$k}) {
			$tailoring{$k} = $v;
		} elsif ($k eq "entry") {
			$tailoring{$k} = $v . $tailoring{$k};
		} else {
			Carp::croak (__PACKAGE__ . "::new - Error: $k is reserved and cannot be overwritten");
		}
	}

	return new Unicode::Collate(%tailoring);
}

1;

=pod

=encoding utf8

=head1 NAME

Lingua::CU::Collate - Collation for Church Slavonic in Unicode

=head1 SYNOPSIS

  use Lingua::CU::Collate;
 #construct
 $Collator = Lingua::CU::Collate->new(); # custom %tailoring may also be specified
 
 #sort
 @sorted = $Collator->sort(@not_sorted);
 
 #compare
 $result = $Collator->cmp($a, $b); # returns 1, 0, or -1.

=head1 DESCRIPTION

Lingua::CU::Collate is a wrapper around Unicode::Collate that provides a custom collation tailoring for Church Slavonic

All text supplied to this library must be encoded in UTF-8 and, unless otherwise specified, is assumed to be
in Unicode. For more on Church Slavonic using Unicode, and for a description of the tailoring, please see the paper
I<Roadmap for Church Slavonic Typography in the Unicode Standard> available at 
http://www.ponomar.net/.

This program is ALPHA STAGE SOFTWARE and is provided with ABSOLUTELY NO WARRANTY of any kind,
express or implied, not even the implied warranties of merchantability, fitness for a purpose, or non-infringement.

=head2 EXPORT

This module provides no methods except for new. It only serves as a wrapper around Unicode::Collate.

=head1 METHODS

=head2 new

Usage: C<new( %tailoring )>

Creates a new Unicode::Collate object. The same keys in C<tailoring> may be specified as would be specified in creating Unicode::Collate directly
however the following are reserved by Lingua::CU::Collate and may not be overwritten: C<suppress>, C<locale_version> 
and C<upper_before_lower>. If C<entry> is specified, it is appended to the entries specified by Lingua::CU::Collate.

=head1 SEE ALSO

This software is part of the Ponomar Project (see http://www.ponomar.net/​).

Be sure to read the I<Roadmap for Church Slavonic Typography in the Unicode Standard> and to download the 
Unicode-compatible Hirmos Ponomar font.

Be sure to read as well C<perluniintro> and C<perllocale> in the Perl manual.

=head1 AUTHOR

Aleksandr Andreev <aleksandr.andreev@gmail.com>

=head1 COPYRIGHT AND LICENSE

Copyright (C) 2012-2014 by Aleksandr Andreev

This library is free software; you can redistribute it and/or modify
it under the same terms as Perl itself, either Perl version 5.14.2 or,
at your option, any later version of Perl you may have available.

=cut

